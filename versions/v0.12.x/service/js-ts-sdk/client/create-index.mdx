---
title: "Create Index"
mode: "wide"
---

Creates and returns an `EncryptedIndex` instance based on the provided configuration.

```typescript
async createIndex(
    indexName: string, 
    indexKey: Uint8Array, 
    indexConfig: IndexIVFPQ | IndexIVFFlat | IndexIVF,
    embeddingModel?: string
): Promise<EncryptedIndex>
```

### Parameters

| Parameter | Type | Description |
|---------------|--------------------|----------------------------------------------------------------------------------------|
| `indexName` | `string` | Name of the index to create. Must be unique within the CyborgDB service. |
| `indexKey` | `Uint8Array` | 32-byte encryption key for the index, used to secure the index data. |
| `indexConfig` | [`IndexIVFPQ`](../types#indexivfpq) \| [`IndexIVFFlat`](../types#indexivfflat) \| [`IndexIVF`](../types#indexivf) | Configuration object specifying the index type (`ivf`, `ivfpq`, or `ivfflat`) and relevant parameters such as `dimension`, `nLists`, `pqDim`, and `pqBits`. |
| `embeddingModel` | `string` | _(Optional)_ Name of the embedding model used to auto-generate embeddings on the server. Defaults to `undefined`, no auto-generation. |

<Note>For more info on auto-generating embeddings, refer to [Auto-Generate Embeddings](../../guides/data-operations/add-items#automatic-embedding-generation).</Note>

### Returns

`Promise<EncryptedIndex>`: A Promise that resolves to an instance of the newly created encrypted index.

### Exceptions

<AccordionGroup>
    <Accordion title="Error">
        - Throws if the index name already exists on the server.
        - Throws if the index configuration is invalid or missing required parameters.
        - Throws if the encryption key is not exactly 32 bytes.
        - Throws if the embedding model is not supported by the server.
    </Accordion>
    <Accordion title="Network/API Errors">
        - Throws if the API request fails due to network issues.
        - Throws if the server returns an HTTP error status.
        - Throws if authentication fails (invalid API key).
    </Accordion>
    <Accordion title="Validation Errors">
        - Throws if field validation fails with detailed error information.
        - Throws if required configuration parameters are missing or invalid.
    </Accordion>
</AccordionGroup>

### Example Usage

#### Basic IVFFlat Index Creation

```typescript
import { Client } from 'cyborgdb';

const client = new Client('http://localhost:8000', 'your-api-key');

const indexName = "my_vector_index";
const indexKey = client.generateKey(); // Generate secure 32-byte key

const indexConfig = {
    dimension: 768,
    nLists: 1024,
    metric: 'cosine',
    type: 'ivfflat'
};

try {
    const index = await client.createIndex(
        indexName, 
        indexKey, 
        indexConfig
    );
    console.log('Index created successfully:', index);
} catch (error) {
    console.error('Failed to create index:', error.message);
}
```

#### IVFPQ Index with Embedding Model

```typescript
import { Client } from 'cyborgdb';

const client = new Client('http://localhost:8000', 'your-api-key');

const indexName = "semantic_search_index";
const indexKey = client.generateKey();

const indexConfig = {
    dimension: 1536,
    nLists: 2048,
    metric: 'cosine',
    type: 'ivfpq',
    pqDim: 64,
    pqBits: 8
};

try {
    const index = await client.createIndex(
        indexName,
        indexKey,
        indexConfig,
        'all-MiniLM-L6-v2'  // Embedding model
    );
    
    console.log('IVFPQ index with embeddings created successfully');
    
    // Store the key securely for future access
    const keyHex = Buffer.from(indexKey).toString('hex');
    console.log('Store this key safely:', keyHex);
} catch (error) {
    console.error('Index creation failed:', error.message);
}
```

#### IVF Index Configuration

```typescript
import { Client } from 'cyborgdb';

const client = new Client('http://localhost:8000', 'your-api-key');

const indexConfig = {
    dimension: 512,
    nLists: 512,
    metric: 'euclidean',
    type: 'ivf'
};

const index = await client.createIndex(
    'basic_ivf_index',
    client.generateKey(),
    indexConfig
);
```

### Key Management

Always store your encryption key securely after creating an index:

```typescript
// Generate and store key
const indexKey = client.generateKey();
const keyHex = Buffer.from(indexKey).toString('hex');

// Store keyHex in your secure key management system
console.log('Save this key:', keyHex);

// Later, to reload the key:
const restoredKey = new Uint8Array(Buffer.from(keyHex, 'hex'));
```
