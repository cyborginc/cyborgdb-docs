---
title: "Train Index"
mode: "wide"
---

Builds the index using the specified training configuration. Required before efficient querying.
Prior to calling this, all queries will be conducted using encrypted exhaustive search.
After, they will be conducted using encrypted ANN search.

```python
def train_index(self, training_config: TrainingConfig = None)
```

### Parameters

| Parameter | Type | Default | Description |
|---------------|--------|---------|-------------------------------------------------------|
| `training_config` | [`TrainingConfig`](../types#trainingconfig) | `TrainingConfig()` | _(Optional)_ Training configuration object. If not provided, uses auto-determined defaults. |

<Tip>There must be at least `2 * n_lists` or `10,000` (whichever is greater) vector embeddings in the index prior to to calling this function.</Tip>

### Exceptions

<AccordionGroup>
    <Accordion title="ValueError">
        - Raises an exception if the index was not created or loaded yet.
    </Accordion>
    <Accordion title="RuntimeError">
        - Raises an exception if there are not enough vector embeddings in the index for training (must be at least `2 * n_lists`).
        - Raises an exception if the index could not be trained.
    </Accordion>
</AccordionGroup>

### Example Usage

```python
# Load index
index = client.load_index(
    index_name=index_name, 
    index_key=index_key
)

# Train the index with custom settings
training_config = cyborgdb.TrainingConfig(
    n_lists=100,
    batch_size=1024, 
    max_iters=50, 
    tolerance=1e-7,
    max_memory=2048
)
index.train_index(training_config)

# Train with default settings (auto-determined configuration)
index.train_index()
```