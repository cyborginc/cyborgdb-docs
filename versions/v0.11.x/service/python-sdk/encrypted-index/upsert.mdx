---
title: "Upsert"
mode: "wide"
---

Adds new vectors to the index or updates existing ones. Supports both dictionary format and separate arrays for IDs and vectors.

```python
# Option 1: Dictionary format
index.upsert(items)

# Option 2: Separate arrays
index.upsert(ids, vectors, contents, metadata)
```

### Parameters

#### Option 1: Dictionary Format
| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| `items` | `List[Dict]` | - | List of dictionaries containing vector data |

#### Option 2: Separate Arrays
| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| `ids` | `List[str]` | - | List of unique vector identifiers |
| `vectors` | `List[List[float]]` or `np.ndarray` | - | Vector data as 2D array |
| `contents` | `List[str]` | `None` | _(Optional)_ Text content for each vector |
| `metadata` | `List[Dict]` | `None` | _(Optional)_ Metadata dictionaries for each vector |

Dictionary Format:

```python
[
  {
    "id": str, # Unique identifier for the vector
    "vector": List[float], # The vector data
    "contents": str, # Optional text content associated with the vector
    "metadata": Dict # Optional key-value pairs for filtering and retrieval
  },
  ...
]
```

### Returns

`None`

### Example Usage

Dictionary format with minimal data:

```python
# Basic vector upsert
items = [
    {
        'id': 'doc1',
        'vector': [0.1, 0.2, 0.3, 0.4]
    },
    {
        'id': 'doc2', 
        'vector': [0.5, 0.6, 0.7, 0.8]
    }
]

index.upsert(items)
```

Separate arrays format:

```python
import numpy as np

# Using separate arrays
ids = ['vec1', 'vec2', 'vec3']
vectors = np.random.rand(3, 128).astype(np.float32)
contents = ['First document', 'Second document', 'Third document']
metadata = [
    {'category': 'tech', 'priority': 'high'},
    {'category': 'science', 'priority': 'medium'},
    {'category': 'business', 'priority': 'low'}
]

index.upsert(ids, vectors, contents, metadata)
```